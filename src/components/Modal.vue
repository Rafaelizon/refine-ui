<script setup lang="ts">
import { Teleport } from 'vue';
import Card from './Card/Card.vue';
import CardBody from './Card/CardBody.vue';
import CardTitle from './Card/CardTitle.vue';
import Button from './Button.vue';
import Icon from './Icon.vue';

export type ModalVariant = 'info' | 'success' | 'warning' | 'danger';

withDefaults(defineProps<{
  show: boolean,
  title?: string,
  titleIcon?: string,
  actionButtons?: boolean,
  confirmText?: string,
  cancelText?: string,
  variant?: ModalVariant
}>(), {
  variant: 'info',
  confirmText: 'Confirmar',
  cancelText: 'Voltar'
})
defineEmits(['on-close', 'on-confirm']);

const colors = new Map<ModalVariant, string>([
  ['info', 'text-sky-600'],
  ['warning', 'text-yellow-500'],
  ['danger', 'text-rose-500'],
  ['success', 'text-teal-500']
])


</script>

<template>
  <Teleport to="body">
    <Transition name="modal-backdrop">
      <div @click.self="$emit('on-close')" v-show="show"
        class="absolute z-20 top-0 left-0 bg-black/60 w-full h-full grid place-items-center">

        <Transition name="modal-content">
          <Card v-if="show" class="transition-all w-[450px]">
            <CardTitle v-if="title" class="!p-2 !pl-4" :icon="titleIcon" :icon-color="colors.get(variant)">
              <p>{{ title }}</p>
              <Button :click="() => $emit('on-close')" variant="secondary-text" class="ml-auto">
                <Icon icon="fa-xmark" />
              </Button>
            </CardTitle>
            <CardBody class="grid gap-4">
              <slot />
              <section class="flex gap-4 justify-center" v-if="actionButtons">
                <Button :click="() => $emit('on-close')" class="justify-center w-full" variant="secondary">
                  {{ cancelText }}
                </Button>
                <Button :click="() => $emit('on-confirm')" class="justify-center w-full">
                  {{ confirmText }}
                </Button>
              </section>
            </CardBody>
          </Card>
        </Transition>
      </div>
    </Transition>
  </Teleport>

</template>

<style>
.modal-backdrop-enter-active,
.modal-backdrop-leave-active {
  transition: all 250ms ease;
}

.modal-backdrop-enter-from,
.modal-backdrop-leave-to {
  opacity: 0;
}

.modal-content-enter-active,
.modal-content-leave-active {
  transition: all 250ms cubic-bezier(0.175, 0.885, 0.32, 1.275);
  /* cubic-bezier(.47,1.64,.41,.8); */
}

.modal-content-enter-from,
.modal-content-leave-to {
  scale: .85;
  opacity: 0;
}
</style>
